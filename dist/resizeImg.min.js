/*!
 * resizeImg.js v1.0.0
 * Github: https://github.com/lyswhut/resizeImg
 *
 * Released under the MIT License.
 *
 * 图片压缩
 * @param {String|Array|Object} imgs 图片路径字符串/图片路径数组/file对象/Blob对象
 * @param {Object} options
 * @param {Number} [options.width] 图片需要压缩的最大宽度，高度会跟随调整
 * @param {Number} [options.height] 图片需要压缩的最大高度，宽度会跟随调整
 * @param {Number} [options.quality=0.8] 压缩质量，不压缩为1
 * @param {String} [options.type] 可选，需要返回的文件类型，如'image/jpeg'、'image/png'等
 * @param {Function} [options.success(result)] 完成的回调函数，若type有值，则返回blob，否则返回base64
 * @example 接收图片路径压缩
 *   __resizeImg('test.jpg', {
 *     width: 200,
 *     height: 200,
 *     quality: 0.9,
 *     type: 'image/jpeg',
 *     success: function($Blob) {
 *       // formData.append("imgFile", $Blob, "file_" + new Date().getTime() + ".jpg");
 *       // ...
 *     }
 *   })
 * @example 接收file对象压缩
 *   var dom_input_file = document.querySelector('#file_1')
 *   __resizeImg(dom_input_file.files[0], {
 *     width: 200,
 *     height: 200,
 *     quality: 0.9,
 *     type: 'image/jpeg',
 *     success: function($Blob){
 *       // formData.append("imgFile", $Blob, "file_" + new Date().getTime() + ".jpg");
 *       // ...
 *     }
 *   })
 *
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("__resizeImg",[],t):"object"==typeof exports?exports.__resizeImg=t():e.__resizeImg=t()}(self,(function(){return e={579:(e,t,r)=>{function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=r(973),o=r(611),i=function(e,t){var r,a,i=document.createElement("canvas");if(t.width&&t.height){var c=e.width/e.height,s=Math.floor(t.width/c);s<t.height?(r=t.width,a=s):(r=Math.floor(t.height*c),a=t.height)}else r=e.width,a=e.height;i.width=r,i.height=a;var f=i.getContext("2d");f.drawImage(e,0,0,r,a);var h=i.toDataURL("image/jpeg",t.quality||.8);return navigator.userAgent.match(/iphone/i)&&(new o(e).render(i,{maxWidth:r,maxHeight:a,quality:t.quality||.8}),h=i.toDataURL("image/jpeg",t.quality||.8)),navigator.userAgent.match(/Android/i)&&(h=(new n).encode(f.getImageData(0,0,r,a),100*t.quality||80)),t.type?function(e,t){for(var r=atob(e.split(",")[1]),a=[],n=0;n<r.length;n++)a.push(r.charCodeAt(n));return new Blob([new Uint8Array(a)],{type:t})}(h,t.type):h};e.exports=function(e,t){switch(a(e)){case"string":var r=new Image;r.src=e,e&&(r.onload=function(){t.success(i(r,t))});break;case"object":if(e instanceof Array){var n=0;e.forEach((function(r,a){if(!r)return console.error("请传入正确的图片地址，当前图片地址为："+r);var o=new Image;o.src=r,o.onload=function(){e.splice(a,1,i(o,t)),++n==e.length&&t.success(e)}}),this)}else{var o=URL.createObjectURL(e);(r=new Image).src=o,e&&(r.onload=function(){t.success(i(r,t))})}}}},973:e=>{e.exports=function(e){Math.round;var t,r,a,n,o,i=Math.floor,c=new Array(64),s=new Array(64),f=new Array(64),h=new Array(64),u=new Array(65535),v=new Array(65535),l=new Array(64),g=new Array(64),d=[],w=0,m=7,y=new Array(64),b=new Array(64),p=new Array(64),I=new Array(256),L=new Array(2048),A=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],x=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],R=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],j=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],M=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],k=[0,1,2,3,4,5,6,7,8,9,10,11],D=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],C=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function E(e,t){for(var r=0,a=0,n=new Array,o=1;o<=16;o++){for(var i=1;i<=e[o];i++)n[t[a]]=[],n[t[a]][0]=r,n[t[a]][1]=o,a++,r++;r*=2}return n}function _(e){for(var t=e[0],r=e[1]-1;r>=0;)t&1<<r&&(w|=1<<m),r--,--m<0&&(255==w?(q(255),q(0)):q(w),m=7,w=0)}function q(e){d.push(I[e])}function H(e){q(e>>8&255),q(255&e)}function O(e,t,r,a,n){for(var o,i=n[0],c=n[240],s=function(e,t){var r,a,n,o,i,c,s,f,h,u,v=0;for(h=0;h<8;++h){r=e[v],a=e[v+1],n=e[v+2],o=e[v+3],i=e[v+4],c=e[v+5],s=e[v+6];var g=r+(f=e[v+7]),d=r-f,w=a+s,m=a-s,y=n+c,b=n-c,p=o+i,I=o-i,L=g+p,A=g-p,x=w+y,U=w-y;e[v]=L+x,e[v+4]=L-x;var R=.707106781*(U+A);e[v+2]=A+R,e[v+6]=A-R;var j=.382683433*((L=I+b)-(U=m+d)),M=.5411961*L+j,k=1.306562965*U+j,D=.707106781*(x=b+m),C=d+D,E=d-D;e[v+5]=E+M,e[v+3]=E-M,e[v+1]=C+k,e[v+7]=C-k,v+=8}for(v=0,h=0;h<8;++h){r=e[v],a=e[v+8],n=e[v+16],o=e[v+24],i=e[v+32],c=e[v+40],s=e[v+48];var _=r+(f=e[v+56]),q=r-f,H=a+s,O=a-s,S=n+c,W=n-c,P=o+i,T=o-i,z=_+P,B=_-P,N=H+S,Q=H-S;e[v]=z+N,e[v+32]=z-N;var F=.707106781*(Q+B);e[v+16]=B+F,e[v+48]=B-F;var G=.382683433*((z=T+W)-(Q=O+q)),J=.5411961*z+G,K=1.306562965*Q+G,V=.707106781*(N=W+O),X=q+V,Y=q-V;e[v+40]=Y+J,e[v+24]=Y-J,e[v+8]=X+K,e[v+56]=X-K,v++}for(h=0;h<64;++h)u=e[h]*t[h],l[h]=u>0?u+.5|0:u-.5|0;return l}(e,t),f=0;f<64;++f)g[A[f]]=s[f];var h=g[0]-r;r=g[0],0==h?_(a[0]):(_(a[v[o=32767+h]]),_(u[o]));for(var d=63;d>0&&0==g[d];d--);if(0==d)return _(i),r;for(var w,m=1;m<=d;){for(var y=m;0==g[m]&&m<=d;++m);var b=m-y;if(b>=16){w=b>>4;for(var p=1;p<=w;++p)_(c);b&=15}o=32767+g[m],_(n[(b<<4)+v[o]]),_(u[o]),m++}return 63!=d&&_(i),r}function S(e){e<=0&&(e=1),e>100&&(e=100),o!=e&&(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],r=0;r<64;r++){var a=i((t[r]*e+50)/100);a<1?a=1:a>255&&(a=255),c[A[r]]=a}for(var n=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],o=0;o<64;o++){var u=i((n[o]*e+50)/100);u<1?u=1:u>255&&(u=255),s[A[o]]=u}for(var v=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],l=0,g=0;g<8;g++)for(var d=0;d<8;d++)f[l]=1/(c[A[l]]*v[g]*v[d]*8),h[l]=1/(s[A[l]]*v[g]*v[d]*8),l++}(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),o=e,console.log("Quality set to: "+e+"%"))}this.encode=function(e,o,i){var u=(new Date).getTime();o&&S(o),d=new Array,w=0,m=7,H(65496),H(65504),H(16),q(74),q(70),q(73),q(70),q(0),q(1),q(1),q(0),H(1),H(1),q(0),q(0),function(){H(65499),H(132),q(0);for(var e=0;e<64;e++)q(c[e]);q(1);for(var t=0;t<64;t++)q(s[t])}(),function(e,t){H(65472),H(17),q(8),H(t),H(e),q(3),q(1),q(17),q(0),q(2),q(17),q(1),q(3),q(17),q(1)}(e.width,e.height),function(){H(65476),H(418),q(0);for(var e=0;e<16;e++)q(x[e+1]);for(var t=0;t<=11;t++)q(U[t]);q(16);for(var r=0;r<16;r++)q(R[r+1]);for(var a=0;a<=161;a++)q(j[a]);q(1);for(var n=0;n<16;n++)q(M[n+1]);for(var o=0;o<=11;o++)q(k[o]);q(17);for(var i=0;i<16;i++)q(D[i+1]);for(var c=0;c<=161;c++)q(C[c])}(),H(65498),H(12),q(3),q(1),q(0),q(2),q(17),q(3),q(17),q(0),q(63),q(0);var v=0,l=0,g=0;w=0,m=7,this.encode.displayName="_encode_";for(var I,A,E,W,P,T,z,B,N,Q=e.data,F=e.width,G=e.height,J=4*F,K=0;K<G;){for(I=0;I<J;){for(T=P=J*K+I,z=-1,B=0,N=0;N<64;N++)T=P+(B=N>>3)*J+(z=4*(7&N)),K+B>=G&&(T-=J*(K+1+B-G)),I+z>=J&&(T-=I+z-J+4),A=Q[T++],E=Q[T++],W=Q[T++],y[N]=(L[A]+L[E+256>>0]+L[W+512>>0]>>16)-128,b[N]=(L[A+768>>0]+L[E+1024>>0]+L[W+1280>>0]>>16)-128,p[N]=(L[A+1280>>0]+L[E+1536>>0]+L[W+1792>>0]>>16)-128;v=O(y,f,v,t,a),l=O(b,h,l,r,n),g=O(p,h,g,r,n),I+=32}K+=8}if(m>=0){var V=[];V[1]=m+1,V[0]=(1<<m+1)-1,_(V)}if(H(65497),i){for(var X=d.length,Y=new Uint8Array(X),Z=0;Z<X;Z++)Y[Z]=d[Z].charCodeAt();d=[];var $=(new Date).getTime()-u;return console.log("Encoding time: "+$+"ms"),Y}var ee="data:image/jpeg;base64,"+btoa(d.join(""));return d=[],$=(new Date).getTime()-u,console.log("Encoding time: "+$+"ms"),ee},function(){var o=(new Date).getTime();e||(e=50),function(){for(var e=String.fromCharCode,t=0;t<256;t++)I[t]=e(t)}(),t=E(x,U),r=E(M,k),a=E(R,j),n=E(D,C),function(){for(var e=1,t=2,r=1;r<=15;r++){for(var a=e;a<t;a++)v[32767+a]=r,u[32767+a]=[],u[32767+a][1]=r,u[32767+a][0]=a;for(var n=-(t-1);n<=-e;n++)v[32767+n]=r,u[32767+n]=[],u[32767+n][1]=r,u[32767+n][0]=t-1+n;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)L[e]=19595*e,L[e+256>>0]=38470*e,L[e+512>>0]=7471*e+32768,L[e+768>>0]=-11059*e,L[e+1024>>0]=-21709*e,L[e+1280>>0]=32768*e+8421375,L[e+1536>>0]=-27439*e,L[e+1792>>0]=-5329*e}(),S(e);var i=(new Date).getTime()-o;console.log("Initialization "+i+"ms")}()}},611:(e,t)=>{var r;!function(){function a(e,t,r,a){var n=e.naturalWidth,o=e.naturalHeight;if(n+o){var i=r.width,c=r.height,s=t.getContext("2d");s.save(),function(e,t,r,a,n){switch(n){case 5:case 6:case 7:case 8:e.width=a,e.height=r;break;default:e.width=r,e.height=a}switch(n){case 2:t.translate(r,0),t.scale(-1,1);break;case 3:t.translate(r,a),t.rotate(Math.PI);break;case 4:t.translate(0,a),t.scale(1,-1);break;case 5:t.rotate(.5*Math.PI),t.scale(1,-1);break;case 6:t.rotate(.5*Math.PI),t.translate(0,-a);break;case 7:t.rotate(.5*Math.PI),t.translate(r,-a),t.scale(-1,1);break;case 8:t.rotate(-.5*Math.PI),t.translate(-r,0)}}(t,s,i,c,r.orientation),function(e){var t=e.naturalWidth;if(t*e.naturalHeight>1048576){var r=document.createElement("canvas");r.width=r.height=1;var a=r.getContext("2d");return a.drawImage(e,1-t,0),0===a.getImageData(0,0,1,1).data[3]}return!1}(e)&&(n/=2,o/=2);var f=1024,h=document.createElement("canvas");h.width=h.height=f;for(var u=h.getContext("2d"),v=a?function(e,t,r){var a=document.createElement("canvas");a.width=1,a.height=r;var n=a.getContext("2d");n.drawImage(e,0,0);for(var o=n.getImageData(0,0,1,r).data,i=0,c=r,s=r;s>i;)0===o[4*(s-1)+3]?c=s:i=s,s=c+i>>1;var f=s/r;return 0===f?1:f}(e,0,o):1,l=Math.ceil(f*i/n),g=Math.ceil(f*c/o/v),d=0,w=0;d<o;){for(var m=0,y=0;m<n;)u.clearRect(0,0,f,f),u.drawImage(e,-m,-d),s.drawImage(h,0,0,f,f,y,w,l,g),m+=f,y+=l;d+=f,w+=g}s.restore(),h=u=null}}var n=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;function o(e){if(window.Blob&&e instanceof Blob){if(!n)throw Error("No createObjectURL function found to create blob url");var t=new Image;t.src=n.createObjectURL(e),this.blob=e,e=t}if(!e.naturalWidth&&!e.naturalHeight){var r=this;e.onload=e.onerror=function(){var e=r.imageLoadListeners;if(e){r.imageLoadListeners=null;for(var t=0,a=e.length;t<a;t++)e[t]()}},this.imageLoadListeners=[]}this.srcImage=e}o.prototype.render=function(e,t,r){if(this.imageLoadListeners){var o=this;this.imageLoadListeners.push((function(){o.render(e,t,r)}))}else{t=t||{};var i=this.srcImage.naturalWidth,c=this.srcImage.naturalHeight,s=t.width,f=t.height,h=t.maxWidth,u=t.maxHeight,v=!this.blob||"image/jpeg"===this.blob.type;s&&!f?f=c*s/i<<0:f&&!s?s=i*f/c<<0:(s=i,f=c),h&&s>h&&(f=c*(s=h)/i<<0),u&&f>u&&(s=i*(f=u)/c<<0);var l={width:s,height:f};for(var g in t)l[g]=t[g];var d=e.tagName.toLowerCase();"img"===d?e.src=function(e,t,r){var n=document.createElement("canvas");return a(e,n,t,r),n.toDataURL("image/jpeg",t.quality||.8)}(this.srcImage,l,v):"canvas"===d&&a(this.srcImage,e,l,v),"function"==typeof this.onrender&&this.onrender(e),r&&r(),this.blob&&(this.blob=null,n.revokeObjectURL(this.srcImage.src))}},void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r)}()}},t={},function r(a){if(t[a])return t[a].exports;var n=t[a]={exports:{}};return e[a](n,n.exports,r),n.exports}(579);var e,t}));